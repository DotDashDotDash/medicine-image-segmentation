# 图像预处理

## 一. RGB颜色空间

* 一个加法混色空间，越叠加越白
* 3个通道
  * `Red`通道
  * `Green`通道
  * `Blue`通道
* 一个像素颜色值`(b, g, r)`，即三个通道的量的组合
* 取值范围
  * `[0, 255]`，灰度
  * `[0, 1]`，归一化之后

## 二. HSV颜色空间

* 人类视觉概念，画家配色
* 3个要素
  * `H/Hue`: 色调，颜色的种类
  * `S/Saturation`: 饱和度，颜色的纯度
  * `V/Value`: 明度，颜色明亮度
* 一个像素颜色值`(h, s, v)`
* 取值范围
  * `[0, 255]`
  * `[0, 1]`
* `HSV`和`RGB`可以相互转化

## 三. 最精确的颜色定义CIE-XYZ颜色空间

* 基于人类颜色视觉的直接测定
* 其他颜色的空间基础
* 人类视觉系统-视锥细胞

## 四. 图片存储的原理

主流颜色空间

* **RGB三通道彩色图**
* **单通道灰度图**: `Gray=R*0.3+G*0.59+B*0.11`

## 五. 为什么要图像预处理

* 其实就是增强，改善图像的视觉效果
* 转化为更适合人或者机器分析处理的形式
* 具体的说:
  * 图像锐化
  * 图像平滑
  * 图像去噪
  * 图像平整

## 六. 图像处理方法

<div align=center><img src="/assets/pics/im1.png"/></div>

## 七. 直方图

* 对图片数据特征分布的一种统计
  * 灰度，颜色
  * 梯度，边缘，形状，纹理
  * 局部特征点，视觉词汇
* 区间
  * 具有一定统计或者物理意义
  * 一种数据或者特征的代表
  * 需要预定义或者基于数据进行**学习**
  * 数值是一种统计量:**概率，频数**
* 直方图的均衡化是指:**利用图像直方图对对比度进行调整的方法**
* 直方图的均衡化实质上是对图像进行非线性拉伸
* 重新分配各个灰度单位中的像素点的个数，使**一定灰度范围像素点的数量的值大致相等**
* **自适应直方图均衡算法(AHE)**
  * 移动模板在原始图片上按照特定的步长华东
  * 每次移动之后，模板区域内做直方图均衡，映射后的结果会赋值给模板区域内的所有的点
  * 每个点会有多次赋值，最终的取值为这些赋值的均值
* **CLAHE**:
  * AHE会过度放大图像中相对均匀区域的噪声，可以采用限制对比度自适应直方图均衡
  * 与普通的自适应直方图均衡比，CLAHE的不同地方在于直方图修剪过程，用修建之后的直方图均衡图像，图像的对比度会更自然

<div align=center><img src="/assets/pics/im2.png"/></div>

### 八. 形态学运算

* **膨胀**: 是图像中的高亮部分进行膨胀，类似于领域扩张
* **腐蚀**: 原图的高亮部分被腐蚀，类似于领域被蚕食

### 九. 滤波和卷积(CNN重点)

* 一般来说，卷积和和图像卷积之后，得到的卷积结果相对于原图像是缩小的
* 如果卷积和比图像大，可以通过边界填充方法进行卷积
  * 补零(目前用的最多，用的最好，但是补零不能补太多，尽量避免用一个非常大的卷积去卷积一个很小的图像)
  * 边界复制(补零不太合适的时候，用边界复制)
  * 块复制
* 平滑均值滤波: **会既不能去掉图像的噪声点，同时也模糊了图像的细节**
* 平滑中值滤波: **奇数尺寸，先排序取中值，有效去除椒盐噪声**

```markdown
什么是椒盐噪声: 由随机的黑点或者白点组成的噪声干扰点
```

<div align=center><img src="/assets/pics/im3.jpg"/></div>

<div align=center><img src="/assets/pics/im4.jpg"/></div>

* 平滑高斯滤波/卷积
  * 奇数尺寸
  * 模拟人眼，关注中心区域: **离关注中心越远，感受的精度就越低**
  * 有效去除高斯噪声
  * 参数
    * x,y是卷积参数坐标
    * **标准差越小，关注的区域越集中**
  * **高斯核**
    * 2D卷积和拆分为两个相同的1D卷积(行卷积和列卷积)

<div align=center><img src="/assets/pics/im5.png"/></div>

* Prewitt卷积/滤波(除此之外还有Sobel还有其他的)

<div align=center><img src="/assets/pics/im6.png" width=400/></div>

<div align=center><img src="/assets/pics/im7.png" width=380/></div>

```markdown
如何让卷积更快?

空域卷积 变成 频域卷积
FFT * FFT
```

## 十. 高斯金字塔(在CNN检测中十分重要)

* 图像金字塔化: 先进行图像的平滑，再进行图像的降采样
* 根据降采样率，得到一系列尺寸逐渐减小的图像
* 操作: n次(高斯卷积->两倍降采样)->n层金字塔
* 目的: 捕捉不同尺寸的物体

<div align=center><img src="/assets/pics/im8.jpg"/></div>
<div align=center><img src="/assets/pics/im9.jpg"/></div>
<div align=center><img src="/assets/pics/im10.jpg"/></div>

## 十一. 拉普拉斯金字塔

* 高斯金字塔没有保存卷积和下采样的高频特性
* 拉普拉斯金字塔所有层丢失的高频信息都保留了，用于图像的恢复